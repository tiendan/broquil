{% extends "base.html" %}
{% load i18n %}
{% load admin_urls %}

{% block content_title %}
<h1>{% trans "View fee status" %}</h1>
{% endblock %}


{% block content %}
    <div id="content-main" class="inner-two-columns">
		<div class="row">
			<div class="col-md-12">
				<form id="distribution_date" role="form"  action="{% url 'elbroquil.views.view_distribution_detail' %}" method="POST"  class="form-horizontal">
		         {% csrf_token %}	
					<div class="form-group">
			      		 <select id="date" name="date" class="form-control" value="{{ selected_date }}">
							<option value="-1">{% trans "CHOOSE DISTRIBUTION DATE" %}</option>
							{% for text, value in distribution_dates %}
						  		<option value="{{ value }}" {% if value == selected_date %}selected{% endif %}>{{ text }}</option>
						  	{% endfor %}
						</select>
						<input id="only-latest" name="only-latest" type="checkbox" {% if only_latest_dates %}checked{% endif %}>
					</div>
				</form>
			</div>
		</div>
		{% if selected_date %}
		<div class="row">
			<div class="col-md-12">
				<div class="panel-group" id="accordion">
				  <div class="panel panel-default">
				    <div class="panel-heading incident-panel">
				      <h4 class="panel-title">
				        <a data-toggle="collapse" href="#collapseTwo">
					    	{% trans "INCIDENTS" %}
				        </a>
				      </h4>
				    </div>
					{% if not_arrived_product_list|length > 0 or amount_changed_product_list|length > 0 %}
				    <div id="collapseTwo" class="panel-collapse collapse in">
				      <div class="panel-body">	
						<div class="row">
							<div class="col-md-3">
								<table class="table table-striped">
								  <thead>
							        <tr>
							          <th>{% trans "Not Arrived"%}</th>
							        </tr>
							      </thead>
							      <tbody>
									{% if not_arrived_product_list|length > 0 %}
										{% for product in not_arrived_product_list %}
							        	<tr><td>{{ product.name }}</td></tr>
										{% endfor %}
									{% else %}
								        <tr><td class="centered">---</td></tr>
									{% endif %}
							      </tbody>
							    </table>
							</div>
						    <div class="col-md-6">
								<table class="table table-striped">
								  <thead>
							        <tr>
							          <th colspan="3">{% trans "Amount Changed"%}</th>
							        </tr>
									{% if amount_changed_product_list|length > 0 %}
								    <tr>
							          <th></th><th class="quantity">{% trans "Ordered"%}</th><th class="quantity">{% trans "Arrived"%}</th>
							        </tr>	
									{% endif %}
							      </thead>
							      <tbody>
									{% if amount_changed_product_list|length > 0 %}
										{% for product in amount_changed_product_list %}
							        	<tr><td>{{ product.name }}</td><td class="quantity">{{ product.total_quantity }} {{ product.unit }}</td><td class="quantity">{{ product.arrived_quantity }} {{ product.unit }}</td></tr>
										{% endfor %}
									{% else %}
								        <tr><td class="centered">---</td></tr>
									{% endif %}
							      </tbody>
							    </table>
							</div>
						</div>
				      </div>
				    </div>
					{% else %}
					<div id="collapseTwo" class="panel-collapse collapse in">
						<div class="panel-body">
							<p>{% trans "NO INCIDENTS"}</p>
						</div>
					</div>
					{% endif %}
				  </div>
				</div>
			</div>
		</div>
		{% endif %}
    </div>
{% endblock %}



{% block extrascripts %}
<script type="text/javascript">
	 $(function() {	
		// Set selected menu item
		$('#menu-item-fee').addClass("active");
		
		// Bind the event so that when form items change, form is submitted
		$("#date").change(function(e) {
			$("#distribution_date").submit();
		});
		
		$("#only-latest").change(function(e) {
			$("#distribution_date").submit();
		});
	  });	
</script>
{% endblock %}